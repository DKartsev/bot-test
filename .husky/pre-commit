#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Не выполнять хук в CI или если явно отключили
if [ -n "$CI" ] || [ "${HUSKY:-1}" = "0" ]; then
  echo "[husky] Skipping pre-commit (CI or HUSKY=0)."
  exit 0
fi

# Если нет npx — пропускаем
command -v npx >/dev/null 2>&1 || {
  echo "[husky] npx not found, skipping lint-staged."
  exit 0
}

# Запускаем lint-staged; даже при ошибке НЕ блокируем коммит
if npx --no -- lint-staged; then
  echo "[husky] lint-staged finished."
  exit 0
else
  echo "[husky] lint-staged failed, but commit is allowed."
  exit 0
fi
